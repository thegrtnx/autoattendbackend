generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  userid    String   @id @default(cuid())
  firstname String
  lastname  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userid])
}

model Students {
  studentid      String          @id @default(cuid())
  firstname      String
  lastname       String
  class          String
  dob            String
  status         Status          @default(ACTIVE)
  gender         Gender
  qrId           String?         @unique
  qrUrl          String?
  qrPublicId     String?
  picture        String?
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  StudentAddress StudentAddress?
  StudentParent  StudentParent[]

  @@index([studentid])
}

model StudentAddress {
  addressid String   @id @default(cuid())
  studentid String   @unique
  student   Students @relation(fields: [studentid], references: [studentid], onDelete: Cascade)
  address   String
  longitude Float?
  latitude  Float?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([addressid])
  @@index([studentid])
  @@index([longitude, latitude])
}

model StudentParent {
  parentid       String     @id @default(cuid())
  studentid      String
  student        Students   @relation(fields: [studentid], references: [studentid], onDelete: Cascade)
  parentname     String
  parentphoneSMS String
  parentphoneWA  String
  parentemail    String
  parentaddress  String?
  parentrole     ParentRole
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt

  @@index([parentid])
  @@index([studentid])
}

enum Gender {
  MALE
  FEMALE
}

enum Status {
  ACTIVE
  INACTIVE
  ARCHIVED
}

enum ParentRole {
  FATHER
  MOTHER
  GUARDIAN
}
